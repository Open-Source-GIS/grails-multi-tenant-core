<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- **************************************************************** -->
<!-- *  PLEASE KEEP COMPLICATED EXPRESSIONS OUT OF THESE TEMPLATES, * -->
<!-- *  i.e. only iterate & print data where possible. Thanks, Jez. * -->
<!-- **************************************************************** -->

<html>
<head>
<!-- Generated by groovydoc (1.7.5) on Tue Feb 08 23:09:50 BRST 2011 -->
<title>TenantTransactionAwareDataSourceProxy (Groovy Documentation)</title>
<meta name="date" content="2011-02-08">
<link href="../groovy.ico" type="image/x-icon" rel="shortcut icon">
<link href="../groovy.ico" type="image/x-icon" rel="icon">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="TenantTransactionAwareDataSourceProxy (Groovy Documentation)";
    }
}
</script>
<noscript>
</noscript>

</head><body onload="windowTitle();" bgcolor="white">
<hr>

<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>

  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <!--<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  -->
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<b>Groovy Documentation</b>
</EM></TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><!--<FONT SIZE="-2">
&nbsp;<A HREF="../groovy/lang/ExpandoMetaClass.ExpandoMetaProperty.html" title="class in groovy.lang"><B>PREV CLASS</B></A>&nbsp;

&nbsp;<A HREF="../groovy/lang/GroovyClassLoader.html" title="class in groovy.lang"><B>NEXT CLASS</B></A></FONT>--></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?DefaultPackage/TenantTransactionAwareDataSourceProxy.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="TenantTransactionAwareDataSourceProxy.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<script type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-frame.html"><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
  <A HREF="../allclasses-frame.html"><B>All Classes</B></A>
</noscript>

</FONT></TD>

</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- ========= END OF TOP NAVBAR ========= -->


<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>

<span CLASS="ClassTitleFont">[Java] Class TenantTransactionAwareDataSourceProxy</span></H2>
<pre>java.lang.Object
  <img src='../inherit.gif'>org.springframework.jdbc.datasource.DelegatingDataSource
      <img src='../inherit.gif'>org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy
          <img src='../inherit.gif'>TenantTransactionAwareDataSourceProxy
</pre><hr>
<PRE>public&nbsp;class TenantTransactionAwareDataSourceProxy
extends org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy

</PRE>

<P>
 This class will intercept any calls by the grails infrastructure for a data source and return the proper
 data source for the current tenant.  If a transaction is already open and you make a tenant change the
 data source will not change.  If you want to change tenants then you need to close all open transactions and then
 change tenant and open the transaction.  Also you should flush and clear the hibernate session first level cache so
 you don't mix tenant data in the cache.  This class only supports JNDI based data sources at the current time.
 
</P>
<hr>


<!-- =========== NESTED CLASS SUMMARY =========== -->

<A NAME="nested_summary"><!-- --></A>


<!-- =========== ENUM CONSTANT SUMMARY =========== -->

<A NAME="enum_constant_summary"><!-- --></A>


<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
    <B>Field Summary</B></FONT></TH>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;<a href='../grails/plugin/multitenant/core/CurrentTenant.html'>CurrentTenant</a></CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#currentTenant">currentTenant</A></B></CODE>
            <BR>
            <P>This is the thread local tenant that is active at the time of the interation with the class.</P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;<a href='../grails/plugin/multitenant/core/datasource/DataSourceUrlResolver.html'>DataSourceUrlResolver</a></CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#dataSourceUrlResolver">dataSourceUrlResolver</A></B></CODE>
            <BR>
            <P>This is the data source url resolver to be used to determine the data source url.</P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;org.apache.log4j.Logger</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#log">log</A></B></CODE>
            <BR>
            <P>This is a logger for logging status or errors</P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>static&nbsp;boolean</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#multiTenant">multiTenant</A></B></CODE>
            <BR>
            <P>This allows the TenantBeanFactoryPostProcessor to assign a proxy to this object in spring since there is one of
 these for each client.</P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;


<!-- =========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>


<!-- =========== ELEMENT SUMMARY =========== -->



<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#D5D5FF" CLASS="TableHeadingColor">
    <TD COLSPAN=2><FONT SIZE="+2">
    <B>Constructor Summary</B></FONT></TD>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD>
            <CODE><B><a href="#TenantTransactionAwareDataSourceProxy(javax.sql.DataSource)">TenantTransactionAwareDataSourceProxy</a></B>(javax.sql.DataSource targetDataSource)</CODE>
            <BR>
            <P>This is the default constructor.</P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2" CLASS="ClassHeadingFont">
    <B>Method Summary</B></FONT></TH>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1" CLASS="ClassItemFont">
            <CODE>javax.sql.DataSource</CODE></FONT>
        </TD>
        <TD>
            <CODE><b><a href="#getTargetDataSource()">getTargetDataSource</a></b>()</CODE>
            <BR>
            <P>This method will return the actual data source for the active tenant.  </P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1" CLASS="ClassItemFont">
            <CODE>void</CODE></FONT>
        </TD>
        <TD>
            <CODE><b><a href="#setCurrentTenant(grails.plugin.multitenant.core.CurrentTenant)">setCurrentTenant</a></b>(<a href='../grails/plugin/multitenant/core/CurrentTenant.html'>CurrentTenant</a> inCurrentTenant)</CODE>
            <BR>
            <P>Since this object is cached this allows you to resolve which tenant this resource applies to.</P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1" CLASS="ClassItemFont">
            <CODE>void</CODE></FONT>
        </TD>
        <TD>
            <CODE><b><a href="#setDataSourceUrlResolver(grails.plugin.multitenant.core.datasource.DataSourceUrlResolver)">setDataSourceUrlResolver</a></b>(<a href='../grails/plugin/multitenant/core/datasource/DataSourceUrlResolver.html'>DataSourceUrlResolver</a> inDataSourceUrlResolver)</CODE>
            <BR>
            <P>This will set the resolver type for this data source object.</P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;
<table BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
                <tr CLASS="TableSubHeadingColor"><th ALIGN="left" COLSPAN="2">
                <b>Methods inherited from class org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy</b>
                </th></tr>
                <tr class="TableRowColor"><td colspan='2'>org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getConnection(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#setReobtainTransactionalConnections(boolean), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#unwrap(java.lang.Class), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getConnection(java.lang.String, java.lang.String), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#isWrapperFor(java.lang.Class), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getLogWriter(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#setLogWriter(java.io.PrintWriter), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#setLoginTimeout(int), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getLoginTimeout(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getTargetDataSource(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#setTargetDataSource(javax.sql.DataSource), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#afterPropertiesSet(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#wait(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#wait(long), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#wait(long, int), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#equals(java.lang.Object), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#toString(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#hashCode(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#getClass(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#notify(), org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy#notifyAll()</td></tr>
                </table>
                &nbsp;<table BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
                <tr CLASS="TableSubHeadingColor"><th ALIGN="left" COLSPAN="2">
                <b>Methods inherited from class org.springframework.jdbc.datasource.DelegatingDataSource</b>
                </th></tr>
                <tr class="TableRowColor"><td colspan='2'>org.springframework.jdbc.datasource.DelegatingDataSource#unwrap(java.lang.Class), org.springframework.jdbc.datasource.DelegatingDataSource#getConnection(java.lang.String, java.lang.String), org.springframework.jdbc.datasource.DelegatingDataSource#getConnection(), org.springframework.jdbc.datasource.DelegatingDataSource#isWrapperFor(java.lang.Class), org.springframework.jdbc.datasource.DelegatingDataSource#getLogWriter(), org.springframework.jdbc.datasource.DelegatingDataSource#setLogWriter(java.io.PrintWriter), org.springframework.jdbc.datasource.DelegatingDataSource#setLoginTimeout(int), org.springframework.jdbc.datasource.DelegatingDataSource#getLoginTimeout(), org.springframework.jdbc.datasource.DelegatingDataSource#getTargetDataSource(), org.springframework.jdbc.datasource.DelegatingDataSource#setTargetDataSource(javax.sql.DataSource), org.springframework.jdbc.datasource.DelegatingDataSource#afterPropertiesSet(), org.springframework.jdbc.datasource.DelegatingDataSource#wait(), org.springframework.jdbc.datasource.DelegatingDataSource#wait(long), org.springframework.jdbc.datasource.DelegatingDataSource#wait(long, int), org.springframework.jdbc.datasource.DelegatingDataSource#equals(java.lang.Object), org.springframework.jdbc.datasource.DelegatingDataSource#toString(), org.springframework.jdbc.datasource.DelegatingDataSource#hashCode(), org.springframework.jdbc.datasource.DelegatingDataSource#getClass(), org.springframework.jdbc.datasource.DelegatingDataSource#notify(), org.springframework.jdbc.datasource.DelegatingDataSource#notifyAll()</td></tr>
                </table>
                &nbsp;<table BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
                <tr CLASS="TableSubHeadingColor"><th ALIGN="left" COLSPAN="2">
                <b>Methods inherited from class java.lang.Object</b>
                </th></tr>
                <tr class="TableRowColor"><td colspan='2'>java.lang.Object#wait(), java.lang.Object#wait(long), java.lang.Object#wait(long, int), java.lang.Object#equals(java.lang.Object), java.lang.Object#toString(), java.lang.Object#hashCode(), java.lang.Object#getClass(), java.lang.Object#notify(), java.lang.Object#notifyAll()</td></tr>
                </table>
                &nbsp;

<P>

<!-- ============ ENUM CONSTANT DETAIL ========== -->

<A NAME="enum_constant_detail"><!-- --></A>


<!-- =========== FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
    <B>Field Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="currentTenant"><!-- --></A><H3>currentTenant</H3>
        <PRE>private&nbsp;<a href='../grails/plugin/multitenant/core/CurrentTenant.html'>CurrentTenant</a> <B>currentTenant</B></PRE>
        <DL>
        <DD> This is the thread local tenant that is active at the time of the interation with the class.
     
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="dataSourceUrlResolver"><!-- --></A><H3>dataSourceUrlResolver</H3>
        <PRE>private&nbsp;<a href='../grails/plugin/multitenant/core/datasource/DataSourceUrlResolver.html'>DataSourceUrlResolver</a> <B>dataSourceUrlResolver</B></PRE>
        <DL>
        <DD> This is the data source url resolver to be used to determine the data source url.
     
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="log"><!-- --></A><H3>log</H3>
        <PRE>private&nbsp;static&nbsp;org.apache.log4j.Logger <B>log</B></PRE>
        <DL>
        <DD> This is a logger for logging status or errors
     
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="multiTenant"><!-- --></A><H3>multiTenant</H3>
        <PRE>public&nbsp;static&nbsp;final&nbsp;boolean <B>multiTenant</B></PRE>
        <DL>
        <DD> This allows the TenantBeanFactoryPostProcessor to assign a proxy to this object in spring since there is one of
 these for each client.
     
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- =========== PROPERTY DETAIL =========== -->

<A NAME="prop_detail"><!-- --></A>


<!-- =========== ELEMENT DETAIL =========== -->

<A NAME="element_detail"><!-- --></A>


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
    <B>Constructor Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="TenantTransactionAwareDataSourceProxy(javax.sql.DataSource)"><!-- --></A><H3>
        TenantTransactionAwareDataSourceProxy</H3>
        <PRE><B>TenantTransactionAwareDataSourceProxy</B>(javax.sql.DataSource targetDataSource)</PRE>
        <DL>
        <DD> This is the default constructor.
     <DL><DT><B>Parameters:</B></DT><DD><code>targetDataSource</code> -  The target data source for this class.</DD></DL>
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
    <B>Method Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="getTargetDataSource()"><!-- --></A><H3>
        getTargetDataSource</H3>
        <PRE>@Override
public&nbsp;javax.sql.DataSource <B>getTargetDataSource</B>()</PRE>
        <DL>
        <DD> This method will return the actual data source for the active tenant.  If no tenant can be resolve then the
 default data source is returned and assumed to connect to the configuration database as tenant 0.   If the
 tenant is null we throw an exception.  If the tenant is 0 we return the original default which should be the
 default data source.  If the tenant is non zero we look up the jndi entry and return it if it is not null.  If it
 is null we throw an InvalidTenantException.
     <DL><DT><B>Returns:</B></DT><DD>The data source for the current thread local tenant.</DD></DL>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="setCurrentTenant(grails.plugin.multitenant.core.CurrentTenant)"><!-- --></A><H3>
        setCurrentTenant</H3>
        <PRE>public&nbsp;void <B>setCurrentTenant</B>(<a href='../grails/plugin/multitenant/core/CurrentTenant.html'>CurrentTenant</a> inCurrentTenant)</PRE>
        <DL>
        <DD> Since this object is cached this allows you to resolve which tenant this resource applies to.
     <DL><DT><B>Parameters:</B></DT><DD><code>inCurrentTenant</code> -  The tenant id this data source is associated with.</DD></DL>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="setDataSourceUrlResolver(grails.plugin.multitenant.core.datasource.DataSourceUrlResolver)"><!-- --></A><H3>
        setDataSourceUrlResolver</H3>
        <PRE>public&nbsp;void <B>setDataSourceUrlResolver</B>(<a href='../grails/plugin/multitenant/core/datasource/DataSourceUrlResolver.html'>DataSourceUrlResolver</a> inDataSourceUrlResolver)</PRE>
        <DL>
        <DD> This will set the resolver type for this data source object.
     <DL><DT><B>Parameters:</B></DT><DD><code>inDataSourceUrlResolver</code> -  The resolver to use to determine the data source for the tenant.  The types could
                                be database or properties file.</DD></DL>
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- ========= END OF CLASS DATA ========= -->
<p>Groovy Documentation</p>
<hr>

</body>
</html>
